# Поиск вакансий с подключением БД
Цель проекта - получить данные о компаниях и вакансиях с сайта hh.ru и загрузить полученные данные в таблицы в БД PostgreSQL.


## Структура базы данных
Таблица companies - содержит информацию о компаниях, предлагающих вакансии.
Поля:
* company_id - ID компании, напрямую взятое из запроса
* company_name - Наименование компании
* company_url - URL компании
* company_alternate_url - Альтернативный URL компании
* trusted - Содержит true / false - можно ли доверять компании

Таблица vacancies - содержит информацию о вакансиях для каждой компании.
* vacancy_id - ID вакансии, напрямую взятое из запрос
* company_id - ID компании, связанное с ID компании из таблицы companies
* vacancy_name - Наименование вакансии
* salary - Зарплата
* salary_currency - Валюта зарплаты
* published_at - Дата публикации
* vacancy_url - URL вакансии
* requirement - Описание компетенций
* responsibility - Описание зоны ответственности


##  Описание функционала программы
 Используя public API подключаемся к сайту вакансий api.hh.ru и получается данные о вакансиях, при этом пользователю 
 даётся возможность выбрать параметры для выполнения запроса:
* keyword - ключевое слово, по которому будет осуществлён поиск
* pages - количество страниц, в которых будет осуществлён поиск
* per_page - количество вакансий на странице

Полученные данные записываются в json-файл 'data/data.json'

Создаётся база данных PostgreSQL 'headhunter', в которой создаются две таблицы:
* companies - содержит информацию о компаниях, предлагающих вакансии
* vacancies - содержит информацию о вакансиях для каждой компании

Полученные через API HeadHunter данные записываются в таблицы.

Класс DBManager предназначен для осуществления пользовательских запросов к базе данных.
Класс имеет следующие методы:
* get_companies_and_vacancies_count - Получает список всех компаний и количество вакансий у каждой компании
* get_all_vacancies - Получает список всех вакансий с указанием названия компании, названия вакансии и зарплаты и ссылки на
        вакансию
* get_avg_salary - Получает среднюю зарплату по вакансиям
* get_vacancies_with_higher_salary - Получает список всех вакансий, у которых зарплата выше средней по всем вакансиям
* get_vacancies_with_keyword - Получает список всех вакансий, в названии которых содержатся переданные в метод слова


## Установка и использование
Для работы программы необходимо установить зависимости, указанные в файле `requirements.txt` или воспользоваться Poetry.
```
pip install -r requirements.txt
```

## Параметры для работы с базой данных PostgreSQL находится в файле database.ini:

```
host=localhost
user=postgres
password=****
port=5433
```

Для запуска программы используется модуль main.py.
Если запустить main.py c параметром '1', то программа пропустит пользовательский запрос параметров запроса к API и 
установит значения по умолчанию. Если параметр не передавать, то программа запросит у пользователя ключевое слово, 
по которому будет сделан запрос к API, количество страниц и количество вакансий на странице. 

После выполнения запроса, создания базы данных и заполнения таблиц, программа предложит пользователю выбрать один 
из пяти запросов к базе данных.

После выполнения запроса можно либо подтвердить завершение работы программы, либо продолжить выполнение запросов.

## TODO:
Можно расширить возможности программы, предложив пользователю сохранить результат выполнения запроса в json-файл. 
Необходимый функционал для этого реализован в классе JsonWorker в модуле file_utils.py.
